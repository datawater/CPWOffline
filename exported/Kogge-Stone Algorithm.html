<!DOCTYPE html>

<html class="client-nojs" dir="ltr" lang="en">
<head>
<meta charset="utf-8"/>
<title>Kogge-Stone Algorithm - Chessprogramming wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Kogge-Stone_Algorithm","wgTitle":"Kogge-Stone Algorithm","wgCurRevisionId":24275,"wgRevisionId":24275,"wgArticleId":1192,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Gong"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Kogge-Stone_Algorithm","wgRelevantArticleId":1192,"wgRequestId":"Zp7DX0KfcgdPZR8tVSrqpgAAAAM","wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgPreferredVariant":"en","wgMFExpandAllSectionsUserOption":false,"wgMFDisplayWikibaseDescriptions":{"search":false,"nearby":false,"watchlist":false,"tagline":false}});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user":"ready","user.options":"loading","user.tokens":"loading","ext.cite.styles":"ready","ext.embedVideo.styles":"ready","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready","mediawiki.skinning.interface":"ready","skins.vector.styles":"ready"});mw.loader.implement("user.options@0bhc5ha",function($,jQuery,require,module){mw.user.options.set([]);});mw.loader.implement("user.tokens@0kthzed",function ( $, jQuery, require, module ) {
mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});/*@nomin*/

});mw.loader.load(["ext.cite.a11y","ext.embedVideo","site","mediawiki.page.startup","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.toc","mediawiki.searchSuggest","skins.vector.js"]);});</script>
<link href="/load.php?debug=false&amp;lang=en&amp;modules=ext.cite.styles%7Cext.embedVideo.styles%7Cmediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.interface%7Cskins.vector.styles&amp;only=styles&amp;printable=1&amp;skin=vector" rel="stylesheet"/>
<script async="" src="/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;printable=1&amp;skin=vector"></script>
<meta content="" name="ResourceLoaderDynamicStyles"/>
<link href="/load.php?debug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;printable=1&amp;skin=vector" rel="stylesheet"/>
<meta content="MediaWiki 1.30.1" name="generator"/>
<meta content="noindex,follow" name="robots"/>
<link href="/images/favicon.ico" rel="shortcut icon"/>
<link href="/opensearch_desc.php" rel="search" title="Chessprogramming wiki (en)" type="application/opensearchdescription+xml"/>
<link href="https://www.chessprogramming.org/api.php?action=rsd" rel="EditURI" type="application/rsd+xml"/>
<link href="/Chessprogramming:About" rel="license"/>
<link href="/index.php?title=Special:RecentChanges&amp;feed=atom" rel="alternate" title="Chessprogramming wiki Atom feed" type="application/atom+xml"/>
<!--[if lt IE 9]><script src="/resources/lib/html5shiv/html5shiv.min.js?40bd4"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Kogge-Stone_Algorithm rootpage-Kogge-Stone_Algorithm skin-vector action-view"> <div class="noprint" id="mw-page-base"></div>
<div class="noprint" id="mw-head-base"></div>
<div class="mw-body" id="content" role="main">
<a id="top"></a>
<div class="mw-indicators mw-body-content">
</div>
<h1 class="firstHeading" id="firstHeading" lang="en">Kogge-Stone Algorithm</h1>
<div class="mw-body-content" id="bodyContent">
<div class="noprint" id="siteSub">From Chessprogramming wiki</div>
<div id="contentSub"></div>
<div class="mw-jump" id="jump-to-nav">
					Jump to:					<a href="#mw-head">navigation</a>, 					<a href="#p-search">search</a>
</div>
<div class="mw-content-ltr" dir="ltr" id="mw-content-text" lang="en"><div class="mw-parser-output"><p><b><a href="Main Page.html" title="Main Page">Home</a> * <a href="Board Representation.html" title="Board Representation">Board Representation</a> * <a href="Bitboards.html" title="Bitboards">Bitboards</a> * <a href="Sliding Piece Attacks.html" title="Sliding Piece Attacks">Sliding Piece Attacks</a> * Kogge-Stone Algorithm</b>
</p>
<div class="thumb tright"><div class="thumbinner" style="width:302px;"><a class="image" href="File:4 bit Kogge Stone Adder Example new.png.html"><img alt="" class="thumbimage" height="409" src="wikipedia/commons/thumb/1/1c/4_bit_Kogge_Stone_Adder_Example_new.png/300px-4_bit_Kogge_Stone_Adder_Example_new.png" srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/1/1c/4_bit_Kogge_Stone_Adder_Example_new.png/450px-4_bit_Kogge_Stone_Adder_Example_new.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/1/1c/4_bit_Kogge_Stone_Adder_Example_new.png/600px-4_bit_Kogge_Stone_Adder_Example_new.png 2x" width="300"/></a> <div class="thumbcaption"><div class="magnify"><a class="internal" href="File:4 bit Kogge Stone Adder Example new.png.html" title="Enlarge"></a></div>4-bit Kogge-Stone adder <sup class="reference" id="cite_ref-1"><a href="#cite note-1">[1]</a></sup></div></div></div>
<p>The <b>Kogge-Stone Algorithm</b> for set-wise <a href="Sliding Pieces.html" title="Sliding Pieces">sliding piece</a> attack generation was first introduced by <a href="Steffan Westcott.html" title="Steffan Westcott">Steffan Westcott</a> in <a href="CCC.html" title="CCC">CCC</a> <sup class="reference" id="cite_ref-2"><a href="#cite note-2">[2]</a></sup> . It is a <a href="Parallel Prefix Algorithms.html" title="Parallel Prefix Algorithms">parallel prefix</a> approach of a occluded <a href="Dumb7Fill.html" title="Dumb7Fill">dumb7</a> <a class="external text" href="https://en.wikipedia.org/wiki/Flood_fill" rel="nofollow">flood-fill</a>, propagating sliding piece attacks like <a class="external text" href="https://en.wikipedia.org/wiki/Carry_(arithmetic)" rel="nofollow">carries</a> of a <a class="external text" href="https://en.wikipedia.org/wiki/Kogge-Stone_adder" rel="nofollow">Kogge-Stone</a> <a href="Combinatorial Logic.html#Adder" title="Combinatorial Logic">hardware adder</a> <sup class="reference" id="cite_ref-3"><a href="#cite note-3">[3]</a></sup> in <a href="Parallel Prefix Algorithms.html#KoggeStoneAdder" title="Parallel Prefix Algorithms">software</a>. One needs to pass sliding pieces as generator set "g" and the set of empty squares as propagator set "p". For appropriate attacks we need to shift the occluded fill <a href="General Setwise Operations.html#OneStepOnly" title="General Setwise Operations">one step</a> further, considering wraps. 
</p>
<table>
<tr>
<td> <div class="thumb tright"><div class="thumbinner" style="width:51px;"><a href="Square Mapping Considerations.html" title="Square Mapping Considerations"><img alt="Cpwmappinghint.JPG" class="thumbimage" height="48" src="images/4/43/Cpwmappinghint.JPG" width="49"/></a> <div class="thumbcaption"><div class="magnify"><a class="internal" href="File:Cpwmappinghint.JPG.html" title="Enlarge"></a></div></div></div></div>
</td>
<td> <i>Code samples and bitboard diagrams rely on <a href="Square Mapping Considerations.html#LittleEndianRankFileMapping" title="Square Mapping Considerations">Little endian file and rank mapping</a></i>.
</td></tr></table>
<div class="toc" id="toc"><div class="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Parallel Prefix"><span class="tocnumber">1</span> <span class="toctext">Parallel Prefix</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Direction-wise Fill"><span class="tocnumber">2</span> <span class="toctext">Direction-wise Fill</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Fill on an empty Board"><span class="tocnumber">2.1</span> <span class="toctext">Fill on an empty Board</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Occluded Fill"><span class="tocnumber">2.2</span> <span class="toctext">Occluded Fill</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Ray-wise Attacks"><span class="tocnumber">2.3</span> <span class="toctext">Ray-wise Attacks</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Generalized Rays"><span class="tocnumber">3</span> <span class="toctext">Generalized Rays</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#See also"><span class="tocnumber">4</span> <span class="toctext">See also</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Publications"><span class="tocnumber">5</span> <span class="toctext">Publications</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Forum Posts"><span class="tocnumber">6</span> <span class="toctext">Forum Posts</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#External Links"><span class="tocnumber">7</span> <span class="toctext">External Links</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#References"><span class="tocnumber">8</span> <span class="toctext">References</span></a></li>
</ul>
</div>
<h1><span class="mw-headline" id="Parallel_Prefix">Parallel Prefix</span></h1>
<p>The routine fillUpOccluded() smears the set bits of bitboard g upwards, but only along set bits of p; a reset bit in p is enough to halt a smear. Other routines have a similar effect.
</p>
<pre>
U64 fillUpOccluded(U64 g, U64 p) {
   g |= p &amp; (g &lt;&lt;  8);
   p &amp;=     (p &lt;&lt;  8);
   g |= p &amp; (g &lt;&lt; 16);
   p &amp;=     (p &lt;&lt; 16);
   g |= p &amp; (g &lt;&lt; 32);
   return g;
}
</pre>
<p>The method chosen in FillUpOccluded() is based on a Kogge-Stone parallel prefix network, because it can be implemented very easily in software. The diagram below (trust me, it really _is_ supposed to look like that) is an illustration of how it works. The corresponding lines of program code are shown on the right. The inputs are fed into the network at the top, pass along the connecting lines, are combined by the # operator at various points, and the outputs appear at the bottom.
</p>
<pre>
x1 x2 x3 x4 x5 x6 x7 x8         Input : g, p
|  |  |  |  |  |  |  |
V  V  V  V  V  V  V  V
|  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |
|\ |\ |\ |\ |\ |\ |\ |
| \| \| \| \| \| \| \|
|  #  #  #  #  #  #  #          g |= p &amp; (g &lt;&lt;  8);
|  |  |  |  |  |  |  |          p &amp;=     (p &lt;&lt;  8);
|\ |\ |\ |\ |\ |\ |  |
| \: \: \: \: \: \:  |
|  \  \  \  \  \  \  |
|  :\ :\ :\ :\ :\ :\ |
|  | \| \| \| \| \| \|
|  |  #  #  #  #  #  #          g |= p &amp; (g &lt;&lt; 16);
|  |  |  |  |  |  |  |          p &amp;=     (p &lt;&lt; 16);
|\ |\ |\ |\ |  |  |  |
| \: \: \: \:  |  |  |
|  \  \  \  \  |  |  |
|  :\ :\ :\ :\ |  |  |
|  | \: \: \: \:  |  |
|  |  \  \  \  \  |  |
|  |  :\ :\ :\ :\ |  |
|  |  | \: \: \: \:  |
|  |  |  \  \  \  \  |
|  |  |  ;\ ;\ :\ :\ |
|  |  |  | \| \| \| \|
|  |  |  |  #  #  #  #          g |= p &amp; (g &lt;&lt; 32);
|  |  |  |  |  |  |  |
|  |  |  |  |  |  |  |
V  V  V  V  V  V  V  V
q1 q2 q3 q4 q5 q6 q7 q8         Output : g
</pre>
<h1><span class="mw-headline" id="Direction-wise_Fill">Direction-wise Fill</span></h1>
<p><i>We further rely on the <a class="external text" href="https://en.wikipedia.org/wiki/Compass_rose" rel="nofollow">compass rose</a> to identify <a href="Direction.html" title="Direction">ray-directions</a>.</i>
</p>
<pre>
  noWe         nort         noEa
          +7    +8    +9
              \  |  /
  west    -1 &lt;-  0 -&gt; +1    east
              /  |  \
          -9    -8    -7
  soWe         sout         soEa
</pre>
<p>Assuming <a href="Square Mapping Considerations.html#LittleEndianRankFileMapping" title="Square Mapping Considerations">little-endian</a> file mapping. Big-endian file mapping has to swap A and H and east and west. As a reminder - <a href="General Setwise Operations.html#ShiftingBitboards" title="General Setwise Operations">shifting bitboards</a> - the base of further stuff.
</p><p><span id="Fillonanemptyboard"></span>
</p>
<h2><span class="mw-headline" id="Fill_on_an_empty_Board">Fill on an empty Board</span></h2>
<p>We already used the south- and north- <a href="Parallel Prefix Algorithms.html" title="Parallel Prefix Algorithms">parallel prefix</a> <a href="Pawn Fills.html" title="Pawn Fills">fill-routines</a> while calculating <a href="Pawn Spans.html" title="Pawn Spans">pawn spans</a>. We need one additional direction step for ray-attacks on the otherwise empty board to exclude sliders. Convenient to initialize <a href="On an empty Board.html#RayAttacks" title="On an empty Board">ray-attacks</a> <a href="Array.html" title="Array">arrays</a> of single sliders. We may conduct those routines from the general occluded fills by passing the universal propagator set. The vertical fills already look familiar.
</p>
<pre>
U64 soutFill(U64 gen) {
   gen |= (gen &gt;&gt;  8);
   gen |= (gen &gt;&gt; 16);
   gen |= (gen &gt;&gt; 32);
   return gen;
}

U64 nortFill(U64 gen) {
   gen |= (gen &lt;&lt;  8);
   gen |= (gen &lt;&lt; 16);
   gen |= (gen &lt;&lt; 32);
   return gen;
}
</pre>
<p>Using explicit propagators as compile time constants to manage the A-, H-file-wraps.
</p>
<pre>
U64 eastFill(U64 gen) {
   const U64 pr0 = notAFile;
   const U64 pr1 = pr0 &amp; (pr0 &lt;&lt; 1);
   const U64 pr2 = pr1 &amp; (pr1 &lt;&lt; 2);
   gen |= pr0 &amp; (gen  &lt;&lt; 1);
   gen |= pr1 &amp; (gen  &lt;&lt; 2);
   gen |= pr2 &amp; (gen  &lt;&lt; 4);
   return gen;
}

U64 noEaFill(U64 gen) {
   const U64 pr0 = notAFile;
   const U64 pr1 = pr0 &amp; (pr0 &lt;&lt;  9);
   const U64 pr2 = pr1 &amp; (pr1 &lt;&lt; 18);
   gen |= pr0 &amp; (gen &lt;&lt;  9);
   gen |= pr1 &amp; (gen &lt;&lt; 18);
   gen |= pr2 &amp; (gen &lt;&lt; 36);
   return gen;
}

U64 soEaFill(U64 gen) {
   const U64 pr0 = notAFile;
   const U64 pr1 = pr0 &amp; (pr0 &gt;&gt;  7);
   const U64 pr2 = pr1 &amp; (pr1 &gt;&gt; 14);
   gen |= pr0 &amp; (gen &gt;&gt;  7);
   gen |= pr1 &amp; (gen &gt;&gt; 14);
   gen |= pr2 &amp; (gen &gt;&gt; 28);
   return gen;
}

U64 westFill(U64 gen) {
   const U64 pr0 = notHFile;
   const U64 pr1 = pr0 &amp; (pr0 &gt;&gt; 1);
   const U64 pr2 = pr1 &amp; (pr1 &gt;&gt; 2);
   gen |= pr0 &amp; (gen &gt;&gt; 1);
   gen |= pr1 &amp; (gen &gt;&gt; 2);
   gen |= pr2 &amp; (gen &gt;&gt; 4);
   return gen;
}

U64 soWeFill(U64 gen) {
   const U64 pr0 = notHFile;
   const U64 pr1 = pr0 &amp; (pr0 &gt;&gt;  9);
   const U64 pr2 = pr1 &amp; (pr1 &gt;&gt; 18);
   gen |= pr0 &amp; (gen &gt;&gt;  9);
   gen |= pr1 &amp; (gen &gt;&gt; 18);
   gen |= pr2 &amp; (gen &gt;&gt; 36);
   return gen;
}

U64 noWeFill(U64 gen) {
   const U64 pr0 = notHFile;
   const U64 pr1 = pr0 &amp; (pr0 &lt;&lt;  7);
   const U64 pr2 = pr1 &amp; (pr1 &lt;&lt; 14);
   gen |= pr0 &amp; (gen &lt;&lt;  7);
   gen |= pr1 &amp; (gen &lt;&lt; 14);
   gen |= pr2 &amp; (gen &lt;&lt; 28);
   return gen;
}
</pre>
<p><span id="OccludedFill"></span>
</p>
<h2><span class="mw-headline" id="Occluded_Fill">Occluded Fill</span></h2>
<p>Occluded fills include sliders, but exclude blockers <sup class="reference" id="cite_ref-4"><a href="#cite note-4">[4]</a></sup>.
</p>
<pre>
U64 soutOccl(U64 gen, U64 pro) {
   gen |= pro &amp; (gen &gt;&gt;  8);
   pro &amp;=       (pro &gt;&gt;  8);
   gen |= pro &amp; (gen &gt;&gt; 16);
   pro &amp;=       (pro &gt;&gt; 16);
   gen |= pro &amp; (gen &gt;&gt; 32);
   return gen;
}

U64 nortOccl(U64 gen, U64 pro) {
   gen |= pro &amp; (gen &lt;&lt;  8);
   pro &amp;=       (pro &lt;&lt;  8);
   gen |= pro &amp; (gen &lt;&lt; 16);
   pro &amp;=       (pro &lt;&lt; 16);
   gen |= pro &amp; (gen &lt;&lt; 32);
   return gen;
}

U64 eastOccl(U64 gen, U64 pro) {
   pro &amp;= notAFile;
   gen |= pro &amp; (gen &lt;&lt; 1);
   pro &amp;=       (pro &lt;&lt; 1);
   gen |= pro &amp; (gen &lt;&lt; 2);
   pro &amp;=       (pro &lt;&lt; 2);
   gen |= pro &amp; (gen &lt;&lt; 4);
   return gen;
}

U64 noEaOccl(U64 gen, U64 pro) {
   pro &amp;= notAFile;
   gen |= pro &amp; (gen &lt;&lt;  9);
   pro &amp;=       (pro &lt;&lt;  9);
   gen |= pro &amp; (gen &lt;&lt; 18);
   pro &amp;=       (pro &lt;&lt; 18);
   gen |= pro &amp; (gen &lt;&lt; 36);
   return gen;
}

U64 soEaOccl(U64 gen, U64 pro) {
   pro &amp;= notAFile;
   gen |= pro &amp; (gen &gt;&gt;  7);
   pro &amp;=       (pro &gt;&gt;  7);
   gen |= pro &amp; (gen &gt;&gt; 14);
   pro &amp;=       (pro &gt;&gt; 14);
   gen |= pro &amp; (gen &gt;&gt; 28);
   return gen;
}

U64 westOccl(U64 gen, U64 pro) {
   pro &amp;= notHFile;
   gen |= pro &amp; (gen &gt;&gt; 1);
   pro &amp;=       (pro &gt;&gt; 1);
   gen |= pro &amp; (gen &gt;&gt; 2);
   pro &amp;=       (pro &gt;&gt; 2);
   gen |= pro &amp; (gen &gt;&gt; 4);
   return gen;
}

U64 soWeOccl(U64 gen, U64 pro) {
   pro &amp;= notHFile;
   gen |= pro &amp; (gen &gt;&gt;  9);
   pro &amp;=       (pro &gt;&gt;  9);
   gen |= pro &amp; (gen &gt;&gt; 18);
   pro &amp;=       (pro &gt;&gt; 18);
   gen |= pro &amp; (gen &gt;&gt; 36);
   return gen;
}

U64 noWeOccl(U64 gen, U64 pro) {
   pro &amp;= notHFile;
   gen |= pro &amp; (gen &lt;&lt;  7);
   pro &amp;=       (pro &lt;&lt;  7);
   gen |= pro &amp; (gen &lt;&lt; 14);
   pro &amp;=       (pro &lt;&lt; 14);
   gen |= pro &amp; (gen &lt;&lt; 28);
   return gen;
}
</pre>
<h2><span class="mw-headline" id="Ray-wise_Attacks">Ray-wise Attacks</span></h2>
<p>Ray-wise attacks need the occluded fills <a href="General Setwise Operations.html#OneStepOnly" title="General Setwise Operations">shift one</a> further, considering wraps.
</p>
<pre>
U64 soutAttacks (U64 rooks,   U64 empty) {return soutOne(soutOccl(rooks,   empty));}
U64 nortAttacks (U64 rooks,   U64 empty) {return nortOne(nortOccl(rooks,   empty));}
U64 eastAttacks (U64 rooks,   U64 empty) {return eastOne(eastOccl(rooks,   empty));}
U64 noEaAttacks (U64 bishops, U64 empty) {return noEaOne(noEaOccl(bishops, empty));}
U64 soEaAttacks (U64 bishops, U64 empty) {return soEaOne(soEaOccl(bishops, empty));}
U64 westAttacks (U64 rooks,   U64 empty) {return westOne(westOccl(rooks,   empty));}
U64 soWeAttacks (U64 bishops, U64 empty) {return soWeOne(soWeOccl(bishops, empty));}
U64 noWeAttacks (U64 bishops, U64 empty) {return noWeOne(noWeOccl(bishops, empty));}
</pre>
<p><span id="GeneralizedRays"></span>
</p>
<h1><span class="mw-headline" id="Generalized_Rays">Generalized Rays</span></h1>
<p>Since <a href="General Setwise Operations.html#Rotate" title="General Setwise Operations">rotate 64</a> works like a <a href="General Setwise Operations.html#GeneralizedShift" title="General Setwise Operations">generalized shift</a> with positive or negative shift amount, it might be applied to get pawn-attacks for both sides - or a Kogge-Stone fill with a direction parameter and small lookups for shift amount and wrap ands, instead of multiple code for eight directions. Of course generalized shift will be a bit slower due to lookups and using cl as the shift amount register.
</p>
<pre>
U64 occludedFill (U64 gen, U64 pro, int dir8)
{
   int r = shift[dir8]; // {+-1,7,8,9}
   pro &amp;= avoidWrap[dir8];
   gen |= pro &amp; rotateLeft(gen, r);
   pro &amp;=       rotateLeft(pro, r);
   gen |= pro &amp; rotateLeft(gen, 2*r);
   pro &amp;=       rotateLeft(pro, 2*r);
   gen |= pro &amp; rotateLeft(gen, 4*r);
   return gen;
}

U64 shiftOne (U64 b, int dir8)
{
   int r = shift[dir8]; // {+-1,7,8,9}
   return rotateLeft(b, r) &amp; avoidWrap[dir8];
}

U64 slidingAttacks (U64 sliders, U64 empty, int dir8)
{
   U64 fill = occludedFill(slider, empty, dir8)
   return shiftOne(fill, dir8);
}

// positve left, negative right shifts
int shift[8] = {9, 1,-7,-8,-9,-1, 7, 8};

U64 avoidWrap[8] =
{
   0xfefefefefefefe00,
   0xfefefefefefefefe,
   0x00fefefefefefefe,
   0x00ffffffffffffff,
   0x007f7f7f7f7f7f7f,
   0x7f7f7f7f7f7f7f7f,
   0x7f7f7f7f7f7f7f00,
   0xffffffffffffff00,
};
</pre>
<h1><span class="mw-headline" id="See_also">See also</span></h1>
<ul><li> <a href="Steffan Westcott.html" title="Steffan Westcott">Steffan Westcott's</a> <a href="Parallel Prefix Algorithms.html#FurtherElaborationsOnKoggeStone" title="Parallel Prefix Algorithms">Elaboration on Kogge-Stone algorithm</a></li>
<li> <a href="Parallel Prefix Algorithms.html#KoggeStoneAdder" title="Parallel Prefix Algorithms">Add/Sub versus Attacks</a></li>
<li> <a href="Design Principles.html" title="Design Principles">Design Principles</a> by <a href="Steffan Westcott.html" title="Steffan Westcott">Steffan Westcott</a></li>
<li> <a href="Dumb7Fill.html" title="Dumb7Fill">Dumb7Fill</a></li>
<li> <a href="Fill by Subtraction.html" title="Fill by Subtraction">Fill by Subtraction</a></li>
<li> <a href="Fill Algorithms.html" title="Fill Algorithms">Fill Algorithms</a></li>
<li> <a href="Pieces versus Directions.html" title="Pieces versus Directions">Pieces versus Directions</a></li>
<li> <a href="SSE2.html#SSE2WrapperinCpp" title="SSE2">SSE2-Wrapper</a> in <a href="Cpp.html" title="Cpp">C++</a></li></ul>
<h1><span class="mw-headline" id="Publications">Publications</span></h1>
<ul><li> <a href="Mathematician.html#PMKogge" title="Mathematician">Peter M. Kogge</a>, <a href="Mathematician.html#HSStone" title="Mathematician">Harold S. Stone</a> (<b>1972</b>). <i><a class="external text" href="https://ntrl.ntis.gov/NTRL/dashboard/searchResults/titleDetail/PB212080.xhtml" rel="nofollow">A Parallel Algorithm for the Efficient Solution of a General Class of Recurrence Equations</a></i>. Technical Report 25, <a href="Stanford University.html" title="Stanford University">Stanford University</a></li>
<li> <a href="Mathematician.html#PMKogge" title="Mathematician">Peter M. Kogge</a> (<b>1973</b>). <i>Parallel Solution of Recurrence Problems</i>. Ph.D. thesis, <a href="Stanford University.html" title="Stanford University">Stanford University</a>, advisor <a href="Mathematician.html#HSStone" title="Mathematician">Harold S. Stone</a>, <a class="external text" href="https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.84.2724&amp;rep=rep1&amp;type=pdf" rel="nofollow">pdf</a></li>
<li> <a href="Mathematician.html#PMKogge" title="Mathematician">Peter M. Kogge</a>, <a href="Mathematician.html#HSStone" title="Mathematician">Harold S. Stone</a> (<b>1973</b>). <i><a class="external text" href="https://ieeexplore.ieee.org/document/5009159" rel="nofollow">A Parallel Algorithm for the Efficient Solution of a General Class of Recurrence Equations</a></i>. <a href="IEEE.html#TOC" title="IEEE">IEEE Transactions on Computers</a>, Vol. C-22, No. 8</li></ul>
<h1><span class="mw-headline" id="Forum_Posts">Forum Posts</span></h1>
<ul><li> <a class="external text" href="https://www.stmintz.com/ccc/index.php?id=252289" rel="nofollow">Re: flood fill attack bitboards</a> by <a href="Steffan Westcott.html" title="Steffan Westcott">Steffan Westcott</a>, <a href="CCC.html" title="CCC">CCC</a>, September 15, 2002</li>
<li> <a class="external text" href="http://www.talkchess.com/forum/viewtopic.php?t=22038.html" rel="nofollow">Kogge Stone Algorithm mistake on chessprogramming Wiki</a> by <a class="new" href="index.php?title=Christopher Conkie&amp;action=edit&amp;redlink=1.html" title="Christopher Conkie (page does not exist)">Christopher Conkie</a>, <a href="CCC.html" title="CCC">CCC</a>, June 29, 2008</li>
<li> <a class="external text" href="http://www.talkchess.com/forum/viewtopic.php?start=0&amp;t=25979&amp;start=10.html" rel="nofollow">Re: Hyperbola Quiesscene: hardly any improvement</a> by <a href="Karlo Balla.html" title="Karlo Balla">Karlo Bala Jr.</a>, <a href="CCC.html" title="CCC">CCC</a>, January 14, 2009 » <a href="Hyperbola Quintessence.html" title="Hyperbola Quintessence">Hyperbola Quintessence</a></li>
<li> <a class="external text" href="http://www.talkchess.com/forum/viewtopic.php?t=46974.html" rel="nofollow">Kogge Stone, Vector Based</a> by <a href="Srdja Matovic.html" title="Srdja Matovic">Srdja Matovic</a>, <a href="CCC.html" title="CCC">CCC</a>, January 22, 2013 » <a href="GPU.html" title="GPU">GPU</a> <sup class="reference" id="cite_ref-5"><a href="#cite note-5">[5]</a></sup> <sup class="reference" id="cite_ref-6"><a href="#cite note-6">[6]</a></sup></li>
<li> <a class="external text" href="http://www.talkchess.com/forum/viewtopic.php?t=48387.html" rel="nofollow">Fast perft on GPU (upto 20 Billion nps w/o hashing)</a> by <a href="Ankan Banerjee.html" title="Ankan Banerjee">Ankan Banerjee</a>, <a href="CCC.html" title="CCC">CCC</a>, June 22, 2013 » <a href="Perft.html" title="Perft">Perft</a>, <a href="GPU.html" title="GPU">GPU</a></li></ul>
<h1><span class="mw-headline" id="External_Links">External Links</span></h1>
<ul><li> <a class="external text" href="https://en.wikipedia.org/wiki/Kogge-Stone_adder" rel="nofollow">Kogge-Stone adder from Wikipedia</a></li>
<li> <a class="external text" href="http://terra.fendrich.se/Terra%20Help-1763.htm.html" rel="nofollow">Kogge-Stone algorithm</a> from <a class="external text" href="http://terra.fendrich.se/Terra%20Help-1647.htm.html" rel="nofollow">Terra Help and Information - Theories</a> by <a href="Peter Fendrich.html" title="Peter Fendrich">Peter Fendrich</a></li>
<li> <a href="Category:Gong.html" title="Category:Gong">Gong</a> - <a class="external text" href="https://en.wikipedia.org/wiki/Shapeshifter_%28Gong_album%29" rel="nofollow">Shapeshifter</a> <sup class="reference" id="cite_ref-7"><a href="#cite note-7">[7]</a></sup>, 1992, <a class="external text" href="https://en.wikipedia.org/wiki/YouTube" rel="nofollow">YouTube</a> Video</li></ul>
<dl><dd> <div class="embedvideo ev_inline ev_top autoResize" style=" width: 646px;"><div class="embedvideowrap" style="width: 640px;"><iframe allowfullscreen="true" frameborder="0" height="360" src="//www.youtube.com/embed/0AZVy2coi6c?" width="640"></iframe></div></div></dd></dl>
<h1><span class="mw-headline" id="References">References</span></h1>
<div class="mw-references-wrap"><ol class="references">
<li id="cite_note-1"><span class="mw-cite-backlink"><a href="#cite ref-1">↑</a></span> <span class="reference-text"><a class="external text" href="https://en.wikipedia.org/wiki/Kogge-Stone_adder" rel="nofollow">Kogge-Stone adder from Wikipedia</a></span>
</li>
<li id="cite_note-2"><span class="mw-cite-backlink"><a href="#cite ref-2">↑</a></span> <span class="reference-text"><a class="external text" href="https://www.stmintz.com/ccc/index.php?id=252289" rel="nofollow">Re: flood fill attack bitboards</a> by <a href="Steffan Westcott.html" title="Steffan Westcott">Steffan Westcott</a>, <a href="CCC.html" title="CCC">CCC</a>, September 15, 2002</span>
</li>
<li id="cite_note-3"><span class="mw-cite-backlink"><a href="#cite ref-3">↑</a></span> <span class="reference-text"><a class="external text" href="http://www.aoki.ecei.tohoku.ac.jp/arith/mg/algorithm.html.html#fsa pfx" rel="nofollow">Hardware algorithms for arithmetic modules</a> from the ARITH research group, Aoki lab., <a class="external text" href="https://en.wikipedia.org/wiki/Tohoku_University" rel="nofollow">Tohoku University</a></span>
</li>
<li id="cite_note-4"><span class="mw-cite-backlink"><a href="#cite ref-4">↑</a></span> <span class="reference-text"><a class="external text" href="http://www.talkchess.com/forum/viewtopic.php?t=22038.html" rel="nofollow">Kogge Stone Algorithm mistake on chessprogramming Wiki</a> by <a class="new" href="index.php?title=Christopher Conkie&amp;action=edit&amp;redlink=1.html" title="Christopher Conkie (page does not exist)">Christopher Conkie</a>, <a href="CCC.html" title="CCC">CCC</a>, June 29, 2008</span>
</li>
<li id="cite_note-5"><span class="mw-cite-backlink"><a href="#cite ref-5">↑</a></span> <span class="reference-text"><a class="external text" href="https://en.wikipedia.org/wiki/Parallel_Thread_Execution" rel="nofollow">Parallel Thread Execution from Wikipedia</a></span>
</li>
<li id="cite_note-6"><span class="mw-cite-backlink"><a href="#cite ref-6">↑</a></span> <span class="reference-text">NVIDIA Compute PTX: Parallel Thread Execution, ISA Version 1.4, March 31, 2009, <a class="external text" href="http://www.nvidia.com/content/CUDA-ptx isa 1.4.pdf.html" rel="nofollow">pdf</a></span>
</li>
<li id="cite_note-7"><span class="mw-cite-backlink"><a href="#cite ref-7">↑</a></span> <span class="reference-text"><a class="external text" href="https://en.wikipedia.org/wiki/Shapeshifting" rel="nofollow">Shapeshifting from Wikipedia</a></span>
</li>
</ol></div>
<p><b><a href="Sliding Piece Attacks.html" title="Sliding Piece Attacks">Up one Level</a></b>
</p>
<!-- 
NewPP limit report
Cached time: 20240722132705
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.091 seconds
Real time usage: 0.862 seconds
Preprocessor visited node count: 229/1000000
Preprocessor generated node count: 498/1000000
Post‐expand include size: 270/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    1.176      1 Template:MappingHint
100.00%    1.176      1 -total
-->
</div>
<!-- Saved in parser cache with key oscar70_mw1-mw_:pcache:idhash:1192-0!canonical and timestamp 20240722132704 and revision id 24275
 -->
</div> <div class="printfooter">
						Retrieved from "<a dir="ltr" href="https://www.chessprogramming.org/index.php?title=Kogge-Stone_Algorithm&amp;oldid=24275">https://www.chessprogramming.org/index.php?title=Kogge-Stone_Algorithm&amp;oldid=24275</a>"					</div>
<div class="catlinks" data-mw="interface" id="catlinks"><div class="mw-normal-catlinks" id="mw-normal-catlinks"><a href="Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="Category:Gong.html" title="Category:Gong">Gong</a></li></ul></div></div> <div class="visualClear"></div>
</div>
</div>
<div id="mw-navigation">
<h2>Navigation menu</h2>
<div id="mw-head">
<div aria-labelledby="p-personal-label" class="" id="p-personal" role="navigation">
<h3 id="p-personal-label">Personal tools</h3>
<ul>
<li id="pt-login"><a accesskey="o" href="index.php?title=Special:UserLogin&amp;returnto=Kogge-Stone+Algorithm&amp;returntoquery=printable%3Dyes.html" title="You are encouraged to log in; however, it is not mandatory [o]">Log in</a></li> </ul>
</div>
<div id="left-navigation">
<div aria-labelledby="p-namespaces-label" class="vectorTabs" id="p-namespaces" role="navigation">
<h3 id="p-namespaces-label">Namespaces</h3>
<ul>
<li class="selected" id="ca-nstab-main"><span><a accesskey="c" href="Kogge-Stone Algorithm.html" title="View the content page [c]">Page</a></span></li>
<li class="new" id="ca-talk"><span><a accesskey="t" href="index.php?title=Talk:Kogge-Stone Algorithm&amp;action=edit&amp;redlink=1.html" rel="discussion" title="Discussion about the content page [t]">Discussion</a></span></li>
</ul>
</div>
<div aria-labelledby="p-variants-label" class="vectorMenu emptyPortlet" id="p-variants" role="navigation">
<h3 id="p-variants-label">
<span>Variants</span>
</h3>
<div class="menu">
<ul>
</ul>
</div>
</div>
</div>
<div id="right-navigation">
<div aria-labelledby="p-views-label" class="vectorTabs" id="p-views" role="navigation">
<h3 id="p-views-label">Views</h3>
<ul>
<li class="selected" id="ca-view"><span><a href="Kogge-Stone Algorithm.html">Read</a></span></li>
<li id="ca-viewsource"><span><a accesskey="e" href="index.php?title=Kogge-Stone Algorithm&amp;action=edit.html" title="This page is protected.
You can view its source [e]">View source</a></span></li>
<li class="collapsible" id="ca-history"><span><a accesskey="h" href="index.php?title=Kogge-Stone Algorithm&amp;action=history.html" title="Past revisions of this page [h]">View history</a></span></li>
</ul>
</div>
<div aria-labelledby="p-cactions-label" class="vectorMenu emptyPortlet" id="p-cactions" role="navigation">
<h3 id="p-cactions-label"><span>More</span></h3>
<div class="menu">
<ul>
</ul>
</div>
</div>
<div id="p-search" role="search">
<h3>
<label for="searchInput">Search</label>
</h3>
<form action="/index.php" id="searchform">
<div id="simpleSearch">
<input accesskey="f" id="searchInput" name="search" placeholder="Search Chessprogramming wiki" title="Search Chessprogramming wiki [f]" type="search"/><input name="title" type="hidden" value="Special:Search"/><input class="searchButton mw-fallbackSearchButton" id="mw-searchButton" name="fulltext" title="Search the pages for this text" type="submit" value="Search"/><input class="searchButton" id="searchButton" name="go" title="Go to a page with this exact name if it exists" type="submit" value="Go"/> </div>
</form>
</div>
</div>
</div>
<div id="mw-panel">
<div id="p-logo" role="banner"><a class="mw-wiki-logo" href="Main Page.html" title="Visit the main page"></a></div>
<div aria-labelledby="p-navigation-label" class="portal" id="p-navigation" role="navigation">
<h3 id="p-navigation-label">Navigation</h3>
<div class="body">
<ul>
<li id="n-mainpage-description"><a accesskey="z" href="Main Page.html" title="Visit the main page [z]">Main page</a></li><li id="n-recentchanges"><a accesskey="r" href="Special:RecentChanges.html" title="A list of recent changes in the wiki [r]">Recent changes</a></li><li id="n-randompage"><a accesskey="x" href="Special:Random.html" title="Load a random page [x]">Random page</a></li><li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li> </ul>
</div>
</div>
<div aria-labelledby="p-tb-label" class="portal" id="p-tb" role="navigation">
<h3 id="p-tb-label">Tools</h3>
<div class="body">
<ul>
<li id="t-whatlinkshere"><a accesskey="j" href="Special:WhatLinksHere/Kogge-Stone Algorithm.html" title="A list of all wiki pages that link here [j]">What links here</a></li><li id="t-recentchangeslinked"><a accesskey="k" href="Special:RecentChangesLinked/Kogge-Stone Algorithm.html" rel="nofollow" title="Recent changes in pages linked from this page [k]">Related changes</a></li><li id="t-specialpages"><a accesskey="q" href="Special:SpecialPages.html" title="A list of all special pages [q]">Special pages</a></li><li id="t-permalink"><a href="index.php?title=Kogge-Stone Algorithm&amp;oldid=24275.html" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="index.php?title=Kogge-Stone Algorithm&amp;action=info.html" title="More information about this page">Page information</a></li> </ul>
</div>
</div>
</div>
</div>
<div id="footer" role="contentinfo">
<ul id="footer-info">
<li id="footer-info-lastmod"> This page was last edited on 11 April 2021, at 22:32.</li>
<li id="footer-info-copyright">Content is available under <a href="Chessprogramming:About.html" title="Chessprogramming:About">Creative Commons Attribution-ShareAlike 3.0 Unported (CC BY-SA 3.0)</a> unless otherwise noted.</li>
</ul>
<ul id="footer-places">
<li id="footer-places-privacy"><a href="Chessprogramming:Privacy policy.html" title="Chessprogramming:Privacy policy">Privacy policy</a></li>
<li id="footer-places-about"><a href="Chessprogramming:About.html" title="Chessprogramming:About">About Chessprogramming wiki</a></li>
<li id="footer-places-disclaimer"><a href="Chessprogramming:General disclaimer.html" title="Chessprogramming:General disclaimer">Disclaimers</a></li>
<li id="footer-places-mobileview"><a class="noprint stopMobileRedirectToggle" href="https://www.chessprogramming.org/index.php?title=Kogge-Stone_Algorithm&amp;printable=yes&amp;mobileaction=toggle_view_mobile">Mobile view</a></li>
</ul>
<ul class="noprint" id="footer-icons">
<li id="footer-copyrightico">
<a href="https://creativecommons.org/licenses/by-sa/3.0/"><img alt="Creative Commons Attribution-ShareAlike 3.0 Unported (CC BY-SA 3.0)" height="31" src="images/cc-by-sa.png" width="88"/></a> </li>
<li id="footer-poweredbyico">
<a href="/www.mediawiki.org/.html"><img alt="Powered by MediaWiki" height="31" src="resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88"/></a> </li>
</ul>
<div style="clear:both"></div>
</div>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.091","walltime":"0.862","ppvisitednodes":{"value":229,"limit":1000000},"ppgeneratednodes":{"value":498,"limit":1000000},"postexpandincludesize":{"value":270,"limit":2097152},"templateargumentsize":{"value":0,"limit":2097152},"expansiondepth":{"value":2,"limit":40},"expensivefunctioncount":{"value":0,"limit":100},"timingprofile":["100.00%    1.176      1 Template:MappingHint","100.00%    1.176      1 -total"]},"cachereport":{"timestamp":"20240722132705","ttl":86400,"transientcontent":false}}});});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":46});});</script>
</body>
</html>
