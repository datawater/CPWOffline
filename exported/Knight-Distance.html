<!DOCTYPE html>

<html class="client-nojs" dir="ltr" lang="en">
<head>
<meta charset="utf-8"/>
<title>Knight-Distance - Chessprogramming wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Knight-Distance","wgTitle":"Knight-Distance","wgCurRevisionId":15229,"wgRevisionId":15229,"wgArticleId":1222,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Samuel Bak"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Knight-Distance","wgRelevantArticleId":1222,"wgRequestId":"Zp7DWLG9G67YuqUGxlgbrwAAAAE","wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgPreferredVariant":"en","wgMFExpandAllSectionsUserOption":false,"wgMFDisplayWikibaseDescriptions":{"search":false,"nearby":false,"watchlist":false,"tagline":false}});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user":"ready","user.options":"loading","user.tokens":"loading","ext.cite.styles":"ready","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready","mediawiki.skinning.interface":"ready","skins.vector.styles":"ready"});mw.loader.implement("user.options@0bhc5ha",function($,jQuery,require,module){mw.user.options.set([]);});mw.loader.implement("user.tokens@0kthzed",function ( $, jQuery, require, module ) {
mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});/*@nomin*/

});mw.loader.load(["ext.cite.a11y","site","mediawiki.page.startup","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.toc","mediawiki.searchSuggest","skins.vector.js"]);});</script>
<link href="/load.php?debug=false&amp;lang=en&amp;modules=ext.cite.styles%7Cmediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.interface%7Cskins.vector.styles&amp;only=styles&amp;printable=1&amp;skin=vector" rel="stylesheet"/>
<script async="" src="/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;printable=1&amp;skin=vector"></script>
<meta content="" name="ResourceLoaderDynamicStyles"/>
<link href="/load.php?debug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;printable=1&amp;skin=vector" rel="stylesheet"/>
<meta content="MediaWiki 1.30.1" name="generator"/>
<meta content="noindex,follow" name="robots"/>
<link href="/images/favicon.ico" rel="shortcut icon"/>
<link href="/opensearch_desc.php" rel="search" title="Chessprogramming wiki (en)" type="application/opensearchdescription+xml"/>
<link href="https://www.chessprogramming.org/api.php?action=rsd" rel="EditURI" type="application/rsd+xml"/>
<link href="/Chessprogramming:About" rel="license"/>
<link href="/index.php?title=Special:RecentChanges&amp;feed=atom" rel="alternate" title="Chessprogramming wiki Atom feed" type="application/atom+xml"/>
<!--[if lt IE 9]><script src="/resources/lib/html5shiv/html5shiv.min.js?40bd4"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Knight-Distance rootpage-Knight-Distance skin-vector action-view"> <div class="noprint" id="mw-page-base"></div>
<div class="noprint" id="mw-head-base"></div>
<div class="mw-body" id="content" role="main">
<a id="top"></a>
<div class="mw-indicators mw-body-content">
</div>
<h1 class="firstHeading" id="firstHeading" lang="en">Knight-Distance</h1>
<div class="mw-body-content" id="bodyContent">
<div class="noprint" id="siteSub">From Chessprogramming wiki</div>
<div id="contentSub"></div>
<div class="mw-jump" id="jump-to-nav">
					Jump to:					<a href="#mw-head">navigation</a>, 					<a href="#p-search">search</a>
</div>
<div class="mw-content-ltr" dir="ltr" id="mw-content-text" lang="en"><div class="mw-parser-output"><p><b><a href="Main Page.html" title="Main Page">Home</a> * <a href="Chess.html" title="Chess">Chess</a> * <a href="Squares.html" title="Squares">Squares</a> * Knight-Distance</b>
</p>
<div class="thumb tright"><div class="thumbinner" style="width:302px;"><a href="http://chgs.elevator.umn.edu/asset/viewAsset/57f3b6787d58ae5f74bf8ba9.html#57f3b6d67d58ae5574bf8baa"><img alt="" class="thumbimage" height="221" src="images/thumb/4/46/SamuelBakAcross.jpg/300px-SamuelBakAcross.jpg" srcset="/images/4/46/SamuelBakAcross.jpg 1.5x" width="300"/></a> <div class="thumbcaption"><div class="magnify"><a class="internal" href="File:SamuelBakAcross.jpg.html" title="Enlarge"></a></div><a href="Category:Samuel Bak.html" title="Category:Samuel Bak">Samuel Bak</a> - Across <sup class="reference" id="cite_ref-1"><a href="#cite note-1">[1]</a></sup></div></div></div>
<p>The <b>Knight-Distance</b> between two squares determines the minimal number of moves a <a href="Knight.html" title="Knight">Knight</a> needs, to reach one square from the other on the otherwise empty board. Due to its move geometry, the knight changes its <a href="Color of a Square.html" title="Color of a Square">square-color</a>, each times it moves. Thus, if squares have different color, the number of moves is odd, otherwise with same square color, even. Smaller <a href="Distance.html" title="Distance">distance</a> does not generally imply smaller KnightDistance. 
<span id="KnightFill"></span>
</p>
<div class="toc" id="toc"><div class="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Knight Fill"><span class="tocnumber">1</span> <span class="toctext">Knight Fill</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Lookups"><span class="tocnumber">2</span> <span class="toctext">Lookups</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#By 64 x 64 Lookup"><span class="tocnumber">2.1</span> <span class="toctext">By 64 x 64 Lookup</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#By 0x88 Square Relations"><span class="tocnumber">2.2</span> <span class="toctext">By 0x88 Square Relations</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#By Absolute Rank-File Distance"><span class="tocnumber">2.3</span> <span class="toctext">By Absolute Rank-File Distance</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#See also"><span class="tocnumber">3</span> <span class="toctext">See also</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#References"><span class="tocnumber">4</span> <span class="toctext">References</span></a></li>
</ul>
</div>
<h1><span class="mw-headline" id="Knight_Fill">Knight Fill</span></h1>
<p>With <a href="Bitboards.html" title="Bitboards">bitboards</a>, one may use <a href="Fill Algorithms.html" title="Fill Algorithms">fill algorithms</a>, to calculate the knight distance by counting the number of fill-cycles until a target set becomes subset of the consecutively expanded <a href="Knight Pattern.html#MultipleKnightAttacks" title="Knight Pattern">knight attacks</a>.
</p>
<pre>
U64 getKnightAttacks(U64 bb) {
   U64 l1 = (bb &gt;&gt; 1) &amp; C64(0x7f7f7f7f7f7f7f7f);
   U64 l2 = (bb &gt;&gt; 2) &amp; C64(0x3f3f3f3f3f3f3f3f);
   U64 r1 = (bb &lt;&lt; 1) &amp; C64(0xfefefefefefefefe);
   U64 r2 = (bb &lt;&lt; 2) &amp; C64(0xfcfcfcfcfcfcfcfc);
   U64 h1 = l1 | r1;
   U64 h2 = l2 | r2;
   return (h1&lt;&lt;16) | (h1&gt;&gt;16) | (h2&lt;&lt;8) | (h2&gt;&gt;8);
}

// no set should be empty -&gt; assert (b1 != 0 &amp;&amp; b2 != 0 )
int calcKnightDistance(U64 b1, U64 b2) {
   int d = 0;
   while ((b1 &amp; b2) == 0) {
      b1 = getKnightAttacks(b1); // as long as sets are disjoint
      d++; // increment distance
   }
   return d;
}

int knightDistance(int a, int b) {
   return calcKnightDistance(C64(1) &lt;&lt; a, C64(1) &lt;&lt; b);
}
</pre>
<h1><span class="mw-headline" id="Lookups">Lookups</span></h1>
<p>One may use this fill-approach to initialize lookup-tables. 
</p>
<h2><span class="mw-headline" id="By_64_x_64_Lookup">By 64 x 64 Lookup</span></h2>
<p>The obvious and likely fastest solution is to go with a 64 times 64 <a href="Array.html" title="Array">array</a>, which takes 4 KByte containing all possible knight-distances which are in the 0..6 range on a 8 times 8 board.
</p>
<pre>
char arrKnightDistance[64][64]; // 4 KByte, requires some initialization code

int knightDistance(int a, int b) {
   return arrKnightDistance[a][b];
}
</pre>
<h2><span class="mw-headline" id="By_0x88_Square_Relations">By 0x88 Square Relations</span></h2>
<p>Similar to <a href="Distance.html" title="Distance">distance</a> or <a href="Manhattan-Distance.html" title="Manhattan-Distance">Manhattan-distance</a>, we may use the <a href="0x88.html#SquareRelations" title="0x88">0x88 square relation</a> approach for a denser 240 sized <a href="Array.html" title="Array">array</a> - but there is one minor issue to consider according to <a href="Diagonals.html" title="Diagonals">diagonal</a> (or <a href="Anti-Diagonals.html" title="Anti-Diagonals">anti-diagonal</a>) neighbored squares. Those squares have usually a knight distance of two, but a distance of four from (or to) the four corner squares. Those extra cases have to be considered by some extra conditions.
</p>
<h2><span class="mw-headline" id="By_Absolute_Rank-File_Distance">By Absolute Rank-File Distance</span></h2>
<p>Another alternative is based on a lookup of two 64 element arrays, one is indexed by some absolute 8 x <a href="Ranks.html#RankDistance" title="Ranks">Rank-Distance</a> plus absolute <a href="Files.html#FileDistance" title="Files">File-Distance</a>, where diagonal neighbors have a unique distance of 9.
</p>
<pre>
const int ndis[64] = { // char
   //  knight-distance
   0, 3, 2, 3, 2, 3, 4, 5,
   3, 2, 1, 2, 3, 4, 3, 4,
   2, 1, 4, 3, 2, 3, 4, 5,
   3, 2, 3, 2, 3, 4, 3, 4,
   2, 3, 2, 3, 4, 3, 4, 5,
   3, 4, 3, 4, 3, 4, 5, 4,
   4, 3, 4, 3, 4, 5, 4, 5,
   5, 4, 5, 4, 5, 4, 5, 6
};

const int corner[64] = { // char
   1, 0, 0, 0, 0, 0, 0, 1,
   0, 0, 0, 0, 0, 0, 0, 0,
   0, 0, 0, 0, 0, 0, 0, 0,
   0, 0, 0, 0, 0, 0, 0, 0,
   0, 0, 0, 0, 0, 0, 0, 0,
   0, 0, 0, 0, 0, 0, 0, 0,
   0, 0, 0, 0, 0, 0, 0, 0,
   1, 0, 0, 0, 0, 0, 0, 1
};

int absRankFileDiff(int a, int b) {
   int rd = (a|7) - (b|7);
   int fd = (a&amp;7) - (b&amp;7);
   return abs(rd) + abs(fd);
}

int knightDistance(int a, int b) {
   int c = absRankFileDiff(a,b);
   int d = ndis[c];
   if (c == 9) d += 2*(corner[a] ^ corner[b]);
   return d;
}
</pre>
<p>Or without a condition:
</p>
<pre>
int knightDistance(int a, int b) {
   int c = absRankFileDiff(a,b);
   int d = ndis[c] + 2*((c == 9) &amp; (corner[a] ^ corner[b]));
   return d;
}
</pre>
<p>To avoid further conditions, with the risk of branch miss-predictions up and then, <a href="Avoiding Branches.html#Abs" title="Avoiding Branches">abs</a> as intrinsic is likely implemented based on following code snippet ...
</p>
<pre>
int abs(int a) {
   int s = a &gt;&gt; 31; // cdq, signed shift, -1 if negative, else 0
   a ^= s;  // ones' complement if negative
   a -= s;  // plus one if negative -&gt; two's complement if negative
   return a;
}
</pre>
<p>... by compilers, on <a href="X86.html" title="X86">x86</a> a sequence three instructions: {cdq, xor, sub} or {cdq, add, xor}.
</p>
<h1><span class="mw-headline" id="See_also">See also</span></h1>
<ul><li> <a href="Distance.html" title="Distance">Distance</a></li>
<li> <a href="Manhattan-Distance.html" title="Manhattan-Distance">Manhattan-Distance</a></li></ul>
<h1><span class="mw-headline" id="References">References</span></h1>
<div class="mw-references-wrap"><ol class="references">
<li id="cite_note-1"><span class="mw-cite-backlink"><a href="#cite ref-1">↑</a></span> <span class="reference-text"><a class="external text" href="http://chgs.elevator.umn.edu/asset/viewAsset/57f3b6787d58ae5f74bf8ba9.html#57f3b6d67d58ae5574bf8baa" rel="nofollow">Chess in the Art of Samuel Bak</a>, <a class="external text" href="http://www.chgs.umn.edu/.html" rel="nofollow">Center for Holocaust &amp; Genocide Studies</a>, <a href="University of Minnesota.html" title="University of Minnesota">University of Minnesota</a></span>
</li>
</ol></div>
<p><b><a href="Squares.html" title="Squares">Up one Level</a></b>
</p>
<!-- 
NewPP limit report
Cached time: 20240722083018
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.018 seconds
Real time usage: 0.019 seconds
Preprocessor visited node count: 91/1000000
Preprocessor generated node count: 184/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 -total
-->
</div>
<!-- Saved in parser cache with key oscar70_mw1-mw_:pcache:idhash:1222-0!canonical and timestamp 20240722083018 and revision id 15229
 -->
</div> <div class="printfooter">
						Retrieved from "<a dir="ltr" href="https://www.chessprogramming.org/index.php?title=Knight-Distance&amp;oldid=15229">https://www.chessprogramming.org/index.php?title=Knight-Distance&amp;oldid=15229</a>"					</div>
<div class="catlinks" data-mw="interface" id="catlinks"><div class="mw-normal-catlinks" id="mw-normal-catlinks"><a href="Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="Category:Samuel Bak.html" title="Category:Samuel Bak">Samuel Bak</a></li></ul></div></div> <div class="visualClear"></div>
</div>
</div>
<div id="mw-navigation">
<h2>Navigation menu</h2>
<div id="mw-head">
<div aria-labelledby="p-personal-label" class="" id="p-personal" role="navigation">
<h3 id="p-personal-label">Personal tools</h3>
<ul>
<li id="pt-login"><a accesskey="o" href="index.php?title=Special:UserLogin&amp;returnto=Knight-Distance&amp;returntoquery=printable%3Dyes.html" title="You are encouraged to log in; however, it is not mandatory [o]">Log in</a></li> </ul>
</div>
<div id="left-navigation">
<div aria-labelledby="p-namespaces-label" class="vectorTabs" id="p-namespaces" role="navigation">
<h3 id="p-namespaces-label">Namespaces</h3>
<ul>
<li class="selected" id="ca-nstab-main"><span><a accesskey="c" href="Knight-Distance.html" title="View the content page [c]">Page</a></span></li>
<li class="new" id="ca-talk"><span><a accesskey="t" href="index.php?title=Talk:Knight-Distance&amp;action=edit&amp;redlink=1.html" rel="discussion" title="Discussion about the content page [t]">Discussion</a></span></li>
</ul>
</div>
<div aria-labelledby="p-variants-label" class="vectorMenu emptyPortlet" id="p-variants" role="navigation">
<h3 id="p-variants-label">
<span>Variants</span>
</h3>
<div class="menu">
<ul>
</ul>
</div>
</div>
</div>
<div id="right-navigation">
<div aria-labelledby="p-views-label" class="vectorTabs" id="p-views" role="navigation">
<h3 id="p-views-label">Views</h3>
<ul>
<li class="selected" id="ca-view"><span><a href="Knight-Distance.html">Read</a></span></li>
<li id="ca-viewsource"><span><a accesskey="e" href="index.php?title=Knight-Distance&amp;action=edit.html" title="This page is protected.
You can view its source [e]">View source</a></span></li>
<li class="collapsible" id="ca-history"><span><a accesskey="h" href="index.php?title=Knight-Distance&amp;action=history.html" title="Past revisions of this page [h]">View history</a></span></li>
</ul>
</div>
<div aria-labelledby="p-cactions-label" class="vectorMenu emptyPortlet" id="p-cactions" role="navigation">
<h3 id="p-cactions-label"><span>More</span></h3>
<div class="menu">
<ul>
</ul>
</div>
</div>
<div id="p-search" role="search">
<h3>
<label for="searchInput">Search</label>
</h3>
<form action="/index.php" id="searchform">
<div id="simpleSearch">
<input accesskey="f" id="searchInput" name="search" placeholder="Search Chessprogramming wiki" title="Search Chessprogramming wiki [f]" type="search"/><input name="title" type="hidden" value="Special:Search"/><input class="searchButton mw-fallbackSearchButton" id="mw-searchButton" name="fulltext" title="Search the pages for this text" type="submit" value="Search"/><input class="searchButton" id="searchButton" name="go" title="Go to a page with this exact name if it exists" type="submit" value="Go"/> </div>
</form>
</div>
</div>
</div>
<div id="mw-panel">
<div id="p-logo" role="banner"><a class="mw-wiki-logo" href="Main Page.html" title="Visit the main page"></a></div>
<div aria-labelledby="p-navigation-label" class="portal" id="p-navigation" role="navigation">
<h3 id="p-navigation-label">Navigation</h3>
<div class="body">
<ul>
<li id="n-mainpage-description"><a accesskey="z" href="Main Page.html" title="Visit the main page [z]">Main page</a></li><li id="n-recentchanges"><a accesskey="r" href="Special:RecentChanges.html" title="A list of recent changes in the wiki [r]">Recent changes</a></li><li id="n-randompage"><a accesskey="x" href="Special:Random.html" title="Load a random page [x]">Random page</a></li><li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li> </ul>
</div>
</div>
<div aria-labelledby="p-tb-label" class="portal" id="p-tb" role="navigation">
<h3 id="p-tb-label">Tools</h3>
<div class="body">
<ul>
<li id="t-whatlinkshere"><a accesskey="j" href="Special:WhatLinksHere/Knight-Distance.html" title="A list of all wiki pages that link here [j]">What links here</a></li><li id="t-recentchangeslinked"><a accesskey="k" href="Special:RecentChangesLinked/Knight-Distance.html" rel="nofollow" title="Recent changes in pages linked from this page [k]">Related changes</a></li><li id="t-specialpages"><a accesskey="q" href="Special:SpecialPages.html" title="A list of all special pages [q]">Special pages</a></li><li id="t-permalink"><a href="index.php?title=Knight-Distance&amp;oldid=15229.html" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="index.php?title=Knight-Distance&amp;action=info.html" title="More information about this page">Page information</a></li> </ul>
</div>
</div>
</div>
</div>
<div id="footer" role="contentinfo">
<ul id="footer-info">
<li id="footer-info-lastmod"> This page was last edited on 22 October 2019, at 21:32.</li>
<li id="footer-info-copyright">Content is available under <a href="Chessprogramming:About.html" title="Chessprogramming:About">Creative Commons Attribution-ShareAlike 3.0 Unported (CC BY-SA 3.0)</a> unless otherwise noted.</li>
</ul>
<ul id="footer-places">
<li id="footer-places-privacy"><a href="Chessprogramming:Privacy policy.html" title="Chessprogramming:Privacy policy">Privacy policy</a></li>
<li id="footer-places-about"><a href="Chessprogramming:About.html" title="Chessprogramming:About">About Chessprogramming wiki</a></li>
<li id="footer-places-disclaimer"><a href="Chessprogramming:General disclaimer.html" title="Chessprogramming:General disclaimer">Disclaimers</a></li>
<li id="footer-places-mobileview"><a class="noprint stopMobileRedirectToggle" href="https://www.chessprogramming.org/index.php?title=Knight-Distance&amp;printable=yes&amp;mobileaction=toggle_view_mobile">Mobile view</a></li>
</ul>
<ul class="noprint" id="footer-icons">
<li id="footer-copyrightico">
<a href="https://creativecommons.org/licenses/by-sa/3.0/"><img alt="Creative Commons Attribution-ShareAlike 3.0 Unported (CC BY-SA 3.0)" height="31" src="images/cc-by-sa.png" width="88"/></a> </li>
<li id="footer-poweredbyico">
<a href="/www.mediawiki.org/.html"><img alt="Powered by MediaWiki" height="31" src="resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88"/></a> </li>
</ul>
<div style="clear:both"></div>
</div>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.018","walltime":"0.019","ppvisitednodes":{"value":91,"limit":1000000},"ppgeneratednodes":{"value":184,"limit":1000000},"postexpandincludesize":{"value":0,"limit":2097152},"templateargumentsize":{"value":0,"limit":2097152},"expansiondepth":{"value":2,"limit":40},"expensivefunctioncount":{"value":0,"limit":100},"timingprofile":["100.00%    0.000      1 -total"]},"cachereport":{"timestamp":"20240722083018","ttl":86400,"transientcontent":false}}});});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":46});});</script>
</body>
</html>
